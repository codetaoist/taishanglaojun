# CodeTaoist 多模块服务统一环境变量模板
# 复制为 .env 并按需修改敏感值

# --------- 基础运行时 ---------
ENV=dev
LOG_LEVEL=info
TRACE_HEADER=X-Trace-Id

# --------- 端口与主机 ---------
GATEWAY_PORT=8080
LAOJUN_API_PORT=8081
TAISHANG_API_PORT=8082

# --------- PostgreSQL（主库） ---------
DB_HOST=127.0.0.1
DB_PORT=5432
DB_NAME=codetaoist
DB_USER=postgres
DB_PASS=postgres
DB_SSL_MODE=disable
DB_MAX_OPEN=25
DB_MAX_IDLE=5

# --------- Redis（缓存 + 分布式锁） ---------
REDIS_ADDR=127.0.0.1:6379
REDIS_PASS=
REDIS_DB=0
REDIS_POOL_SIZE=10

# --------- JWT 与权限 ---------
JWT_SECRET=change-me-now-please-use-256-bit-random
JWT_EXPIRY=3600
# 可选：RS256 公/私钥路径（留空则使用 HS256）
JWT_PRIVATE_KEY_PATH=
JWT_PUBLIC_KEY_PATH=

# --------- 对象存储（插件包、模型文件） ---------
STORAGE_TYPE=s3   # s3|minio|local
STORAGE_ENDPOINT=http://localhost:9000
STORAGE_BUCKET=codetaoist
STORAGE_ACCESS_KEY=minioadmin
STORAGE_SECRET_KEY=minioadmin
STORAGE_REGION=us-east-1
# 本地模式路径
STORAGE_LOCAL_PATH=./data/storage

# --------- 向量库后端 ---------
VECTOR_BACKEND=pgvector   # pgvector|milvus|faiss
# pgvector 无需额外配置，使用主库即可
# milvus 配置
MILVUS_ADDR=127.0.0.1:19530
MILVUS_USER=root
MILVUS_PASS=

# --------- 插件运行时 ---------
PLUGIN_RUNTIME=docker   # docker|native
# docker 模式
PLUGIN_DOCKER_NETWORK=codetaoist_plugin
PLUGIN_CPU_LIMIT=1000m
PLUGIN_MEM_LIMIT=512Mi
PLUGIN_GPU_ENABLE=false
PLUGIN_GPU_LIMIT=1
# 原生模式（仅开发调试）
PLUGIN_NATIVE_DIR=./plugins/bin

# --------- 观测性 ---------
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics
JAEGER_ENDPOINT=http://localhost:14268/api/traces

# --------- 资源配额 & 限流 ---------
QUOTA_VECTOR_MAX_DIM=1536
QUOTA_VECTOR_MAX_BYTES=104857600   # 100 MiB
RATE_LIMIT_RPS=100
RATE_LIMIT_BURST=200

# --------- 安全 ---------
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173
CORS_MAX_AGE=86400

# --------- 备份与保留 ---------
AUDIT_LOG_RETENTION_DAYS=90
VECTOR_INDEX_REBUILD_CRON="0 3 * * *"

# --------- 本地开发快捷开关 ---------
DEV_SKIP_SIGNATURE=false
DEV_MOCK_VECTOR=false