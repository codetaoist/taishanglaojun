# 威胁模型（STRIDE）与防护策略

针对分域路由、插件系统与原生终端，使用 STRIDE 分析并制定防护措施。[0]

## STRIDE 分析
- 伪造（Spoofing）：令牌伪造、签名绕过、插件包冒充。
- 篡改（Tampering）：插件包被改写、任务结果被篡改、模型参数被改。
- 抵赖（Repudiation）：关键操作无审计、日志不可追踪。
- 信息泄露（Information Disclosure）：密钥泄露、隐私数据外泄、日志敏感信息。
- 拒绝服务（Denial of Service）：批量任务压垮、向量检索耗尽资源、插件启动风暴。
- 提权（Elevation of Privilege）：越权调用、前端绕过鉴权、插件恶意代码执行。

## 防护策略
- 身份与鉴权：强制 JWT + 作用域；后端中间件校验；终端绑定设备指纹。
- 传输与存储：HTTPS；敏感字段加密；密钥管理与轮转。
- 插件安全：签名校验、哈希比对、权限声明审查与沙箱执行（隔离进程/线程）。
- 数据一致性：契约测试与幂等键；审计日志写入与不可篡改存储（WORM/外部归档）。
- 资源保护：限流与熔断；任务队列优先级；向量索引参数保护与配额。
- 监控与告警：关键指标（QPS、失败率、延迟、错误码）与安全事件告警。

## 响应与恢复
- 事件响应流程：发现 → 分级 → 隔离 → 根因 → 修复 → 复盘。
- 回滚与隔离：插件版本快速回滚；禁用高风险模型与向量集合；冻结任务队列。

> 参考：[0] https://www.doubao.com/thread/w1745a17f59b91183