# 测试策略（分终端工具与场景）

目标：以较低成本保证高可靠性，覆盖单元、集成、契约、端到端与性能测试。[0]

## 单元测试
- 业务逻辑与适配器级别；覆盖核心分支与错误处理。

## 集成测试
- 数据库/缓存/向量库与服务集成；使用测试容器或本地服务。

## 契约测试（API）
- 工具：`schemathesis` 针对 `openapi/*.yaml` 进行基于属性的探测。
- 覆盖：成功/错误码场景、必填字段缺失、边界与并发。
- 集成：CI 中分阶段执行（P1 必过），生成报告与基线。

## 端侧测试（原生）
- iOS：`XCTest` 单元/集成、`XCUITest` UI 自动化、性能（Instruments）。
- Android：`JUnit`/`Robolectric` 单元、`Espresso` UI、`Macrobenchmark` 性能。
- Harmony：`DevEco` 测试框架；多设备协同场景。
- 桌面：`Playwright` UI、`pytest` 端侧接口与文件系统操作。

## 插件测试
- 清单校验：字段完整性、签名校验、权限位与资源配额。
- 生命周期：`Init/Start/Stop/Health` 测试与异常回滚。
- UI 集成：组件注册、权限提示与交互路径。

## 性能与稳定性
- 指标：CPU/Mem/GPU/电量/IO；端侧可见性与采样率。
- 压力与并发：接口限流、插件并发启动与资源争用。
- 崩溃与回滚：故障注入、自动回滚策略与审计。

## 安全与合规
- 权限与数据：最小授权验证、敏感数据脱敏与访问审计。
- 供应链安全：依赖扫描、签名与来源校验、CI 里程碑门禁。

> 参考：[0] https://www.doubao.com/thread/w30e30a4dcadbb935